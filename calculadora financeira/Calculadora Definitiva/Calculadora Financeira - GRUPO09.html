<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Inteligente</title>
    <link rel="stylesheet" href="estilizacaocalculadora.css">
</head>

<body>
    <div>
        <h1>Perda de vendas, Ticket médio e taxa de conversão</h1>
        Inserir total de clientes que entraram na loja no dia: <input type="text" id="input_total">
        <br><br>
        Inserir total de vendas realizada no dia: <input type="text" id="input_vendas">
        <br><br>
        Inserir faturamento do dia (em R$): <input type="text" id="input_valor">
        <br><br>
        <button onclick="exibir ()">Calcular Ticket e Conversão</button>
        <br><br>
        <div id="div_mensagem"></div>
    </div>
    <div>
        <h1>Simulador financeiro para loja/supermercado</h1>
        Qual o seu faturamento mensal (em R$): <input type="number" id="input_faturamento">
        <br><br>
        Custo fixo mensal (em R$): <input type="number" id="input_custo_fixo">
        <br><br>
        Custo variável (em %): <input type="number" id="input_custo_variavel">
        <br><br>
        Investimento inicial (em R$): <input type="number" id="input_investimento">
        <br><br>
        <button onclick="simular()">Calcular Simulador Financeiro</button>
        <br><br>
        <div id="div_simulador"></div>
    </div>

</body>

</html>
<script>
    function exibir() {
        var total = Number(input_total.value)
        var vendas = Number(input_vendas.value)
        var valor = Number(input_valor.value)
        var ticket = valor / vendas
        var taxa = vendas / total * 100
        var clientes_perdidos = total * (100 - taxa) / 100;
        var perda_vendas = clientes_perdidos * ticket;

        if (taxa < 50) {
            div_mensagem.innerHTML = `Ticket médio: R$ ${ticket.toFixed(2)} <br> 
        <span style="color: red;">Taxa de conversão: ${taxa.toFixed(2)}%</span> <br>`
        } else {
            div_mensagem.innerHTML = `Ticket médio: R$ ${ticket.toFixed(2)} <br> 
        Taxa de conversão: ${taxa.toFixed(2)}% <br>`
        }

        if (perda_vendas > 0) {
            div_mensagem.innerHTML +=
                `Clientes Perdidos: ${clientes_perdidos}<br>
                <span style=" color:red;">Perda Oportunidade de Venda: R$ ${perda_vendas.toFixed(2)}<span><br>`
        } else {
            div_mensagem.innerHTML +=
                `Clientes Perdidos: ${clientes_perdidos}<br>
                <span style=" color:green;">Perda Oportunidade de Venda: R$ ${perda_vendas.toFixed(2)}<span><br>`
        }

    }

    function simular() {
        var faturamento = Number(input_faturamento.value)
        var custoFixo = Number(input_custo_fixo.value)
        var custoVariavel = Number(input_custo_variavel.value)
        var investimento = Number(input_investimento.value)

        var valorCustoVariavel = (custoVariavel / 100) * faturamento
        var lucroBruto = faturamento - valorCustoVariavel
        var lucroLiquido = lucroBruto - custoFixo
        var margemLucro = (lucroLiquido / faturamento) * 100

        var payback = investimento / lucroLiquido

        var inteiropayback = (payback.toFixed(0))


        var paybackapossistema = payback * 0.8
        var inteiropaybackapossistema = (paybackapossistema.toFixed(0))

        if (payback > inteiropayback) {
            var dias = (payback - inteiropayback) * 30
        } else {
            var dias = (inteiropayback - payback) * 30
        }
        if (paybackapossistema > inteiropaybackapossistema) {
            var diasapossistema = (paybackapossistema - inteiropaybackapossistema) * 30
        } else {
            var diasapossistema = (inteiropaybackapossistema - paybackapossistema) * 30
        }

        if (faturamento <= custoFixo) {
            alert('Faturamento mensal menor ou igual que custo fixo mensal')
        } else if (lucroLiquido <= 0) {
            alert('Custo variável muito grande')
        }

        if (payback >= 12) {
            var ano = payback / 12
            var meses = payback % 12
            var anosistema = paybackapossistema / 12
            var mesessistema = paybackapossistema % 12
            div_simulador.innerHTML =
                `Lucro bruto: R$ ${lucroBruto.toFixed(2)} <br>
        Lucro líquido: R$ ${lucroLiquido.toFixed(2)}. <br>
        Margem de lucro: ${margemLucro.toFixed(2)}%. <br>
        Payback: ≅ ${ano.toFixed(0)} ano(s) e ${meses.toFixed(0)} mês(es) e ${dias.toFixed(0)} dias.<br><br>
        Estima-se que com nosso sistema, o payback cai até 20%, para ≅ ${ano.toFixed(0)}  ano(s) ${meses.toFixed(0)} mês(es) e ${diasapossistema.toFixed(0)} dias.`
        } else {
            div_simulador.innerHTML =
                `Lucro bruto: R$ ${lucroBruto.toFixed(2)} <br>
        Lucro líquido: R$ ${lucroLiquido.toFixed(2)}. <br>
        Margem de lucro: ${margemLucro.toFixed(2)}%. <br>
        Payback: ≅ ${payback.toFixed(0)} mês(es) e ${dias.toFixed(0)} dias.<br><br>
        Estima-se que com nosso sistema, o payback cai até 20%, para ≅ ${paybackapossistema.toFixed(0)} mês(es) e ${diasapossistema.toFixed(0)} dias.`
        }
    }
</script>

